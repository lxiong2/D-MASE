k = 1;

%% PW 14 bus case 
% Polar results
% numbus = 14;
% x = [0.0000000000000000;
%     -0.0908267141386695;
%     -0.1089143426654649;
%     -0.1485175407205641;
%     -0.1323447464566713;
%     -0.2280900983537723;
%     -0.2065660539581082;
%     -0.2065659663111520;
%     -0.2367788498625365;
%     -0.2404926918120009;
%     -0.2367712414561624;
%     -0.2432688116004266;
%     -0.2446088592878369;
%     -0.2582798206552778;
%     1.0599999427795410;
%     1.0449999309531599;
%     1.0357887047348926;
%     1.0319210818052977;
%     1.0347186607351298;
%     1.0450431051688001;
%     1.0530933573977659;
%     1.0900000454534755;
%     1.0425722829553701;
%     1.0355433120664188;
%     1.0368204190699797;
%     1.0307012882817059;
%     1.0267663401966221;
%     1.0173917310026952]; 

%% PW 118 bus case
% Polar results
numbus = 118;
thetas = [0.195255191746628;
0.204646950400262;
0.210920503866018;
0.275959331564038;
0.284431074370523;
0.235866361353393;
0.228039023921562;
0.373901448697508;
0.500509474755601;
0.632821315547493;
0.230909582043131;
0.221670078400343;
0.206621125917201;
0.208912052744455;
0.203058283515407;
0.216442557997906;
0.248242570157294;
0.208369675376852;
0.199856114504929;
0.214891212876112;
0.242405943931563;
0.286814060615002;
0.372527141156287;
0.369480686251797;
0.494969300263979;
0.527198464485235;
0.273815644620642;
0.243883185957581;
0.226749762529432;
0.338101638878669;
0.228855905446819;
0.264417129374714;
0.192649620641097;
0.203627021852978;
0.195878386890027;
0.195725812481741;
0.212641066845423;
0.305119016378487;
0.151964822057532;
0.132368738302624;
0.124432809748450;
0.151868473169279;
0.201893051485671;
0.243988737940269;
0.275462319222360;
0.324107514667393;
0.362771100571468;
0.349079276598008;
0.366531443819637;
0.330985073394031;
0.285327075038381;
0.268700461795398;
0.251721886807684;
0.267661996129479;
0.262614952490860;
0.265866138116701;
0.286834079632459;
0.271890104816694;
0.339361355250525;
0.405217855982885;
0.420796335290054;
0.409868508571579;
0.399184806371653;
0.429108709777725;
0.482013967887535;
0.479888063952468;
0.434148139389201;
0.480330923381765;
0.523598775598299;
0.394769460991460;
0.387679129257456;
0.368932283103642;
0.383988095966965;
0.377903796613312;
0.399832077361657;
0.379709445895756;
0.465603754254378;
0.460239808531163;
0.465343939862994;
0.504209764251668;
0.488141244710980;
0.474455736580613;
0.495208473881729;
0.539396121696566;
0.566505351704434;
0.542603966253748;
0.547128079093723;
0.621127059955767;
0.691890852570967;
0.580101416723955;
0.580427357793439;
0.589128980406503;
0.536569410842871;
0.498968884301275;
0.482015572801299;
0.479105699307294;
0.485540730831690;
0.477170282310446;
0.470892392100226;
0.488308143626077;
0.515777511631921;
0.562881428475204;
0.425564193406701;
0.377655210096478;
0.358070909951624;
0.353745613391776;
0.305048832779866;
0.337285637966082;
0.329445226243985;
0.314804544961346;
0.343516614618216;
0.260712978136344;
0.246862371341791;
0.258546578667138;
0.258395434199048;
0.473849931071286;
0.194774548400947;
0.382408262151969] - 0.523598775598299;

voltages = [0.9549999840119077;
0.9713930850067304;
0.9669887337128288;
0.9980000264789608;
0.9990875593844304;
0.9900000102633579;
0.9893286187809573;
1.0149999864314212;
1.0429181731326966;
1.0499999530788020;
0.9845619526983763;
0.9900000102653677;
0.9678836652455759;
0.9835880710362431;
0.9700000293200786;
0.9826515861165075;
0.9912045760259437;
0.9729999907366588;
0.9632003586697450;
0.9574314431523266;
0.9576999239269638;
0.9683850640773174;
0.9978216758693581;
0.9919999871372206;
1.0440370377306969;
1.0149999869097168;
0.9679999960830256;
0.9615688488991084;
0.9632137119987899;
1.0096215596285405;
0.9670000087729520;
0.9632193337946033;
0.9691979133364075;
0.9840000272635666;
0.9798257539677918;
0.9799999982667527;
0.9870000175130730;
1.0054616963140592;
0.9685802393437878;
0.9700000288668311;
0.9668359121583509;
0.9850000145253024;
0.9771907392339514;
0.9845507359106778;
0.9864777571555846;
1.0049999954086446;
1.0170486781519179;
1.0206367726108372;
1.0249999763676956;
1.0010858493931083;
0.9668822499885200;
0.9568239380902132;
0.9459858936793449;
0.9549999835443711;
0.9520000221702531;
0.9539999964198838;
0.9705856911785890;
0.9590422063753854;
0.9850000145842818;
0.9931571624328691;
0.9950000050757832;
0.9980000260556371;
0.9971658121118663;
1.0053025773475821;
1.0232668684645760;
1.0499999526340513;
1.0196950077431999;
1.0155673649627428;
1.0349999666213989;
0.9840000383292026;
0.9868456567978023;
0.9800000254902748;
0.9910000070177161;
0.9579984074810622;
0.9673271315485540;
0.9430001026997572;
1.0060002217430140;
1.0034217310238061;
1.0092251486728512;
1.0399999655516601;
1.0300770559930879;
0.9887399348122546;
0.9845199636365224;
0.9797525586225170;
0.9850000169913398;
0.9866907530522946;
1.0149999877304818;
0.9874578791958564;
1.0049999965468399;
0.9850000157484761;
0.9800000207240621;
0.9922758075823835;
0.9869037744757034;
0.9905711871242932;
0.9809217350746932;
0.9926664508203292;
1.0113655412446394;
1.0235098263671754;
1.0099999916246703;
1.0169999623370527;
0.9924338796690468;
0.9909990390554264;
1.0007088052831596;
0.9710000180190534;
0.9659902004803683;
0.9617874108571557;
0.9520000241721599;
0.9668103304305710;
0.9674614859231628;
0.9729999922753245;
0.9800000213784478;
0.9750000261354072;
0.9929999717611269;
0.9602212432639184;
0.9601354948167961;
1.0049999956510398;
0.9738244569150804;
0.9494332499282304];

x = [thetas; voltages];

%% Convert polar state variables to rectangular form
newth = x(1:numbus,k);
newV = x(numbus+1:(2*numbus),k);
newe = zeros(numbus,1);
newf = zeros(numbus,1);
for a = 1:numbus
    newe(a) = newV(a)*cos(newth(a));
    newf(a) = newV(a)*sin(newth(a));
end
newe
newf

%% Convert rectangular state variables to polar form
% newe = x(1:numbus,k);
% newf = [0; x(numbus+1:(2*numbus-1),k)];
% newth = zeros(numbus,1);
% newV = zeros(numbus,1);
% for a = 1:numbus
%     newV(a) = sqrt(newe(a)^2+newf(a)^2);
%     newth(a) = atan(newf(a)/newe(a));
% end
% newth
% newV
